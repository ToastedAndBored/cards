<div id="card-component" class="main-container">
    <div class="inner-container">
        <table class="top-element">
            <tr>
                <td class="top-td">
                    <img
                        class="top-img card-img-btn"
                        src="/static/qr-code-.svg"
                        toggle-visibility="#qr-layer"
                    />
                </td>
                <td>
                    {{if .Card.Logo}}
                    <img
                        id="card-logo"
                        src="/{{.Card.Logo}}"
                        alt="Company logo"
                        preview-for="#input-logo"
                        initial-sync="no"
                        preview-for="#input-logo"
                    />
                    {{else}}
                    <img
                        id="card-logo"
                        src=""
                        alt="Company logo"
                        preview-for="#input-logo"
                        initial-sync="no"
                        preview-for="#input-logo"
                    />
                    {{end}}
                </td>
                <td class="top-td">
                    <a href="/">
                        <img
                            class="top-img card-img-btn"
                            src="/static/favicon-192.svg"
                        />
                    </a>
                </td>
            </tr>
        </table>
        <hr />
        <button class="element">{{ T "AddToContacts" .Lang }}</button>
        {{ if .Card.Fields.IsHidden }}
        <div class="element card-hidden-msg">{{ T "HiddenCard" .Lang }}</div>
        {{ end }}
        <div class="avatar" hide-when-no-content="#card-image-preview">
            {{if .Card.Avatar}}
            <img
                id="card-image-preview"
                src="/{{.Card.Avatar}}"
                alt="Your avatar preview"
                preview-for="#input-avatar"
                initial-sync="no"
                style="background-color: white"
            />
            {{else}}
            <img
                id="card-image-preview"
                src=""
                alt="Your avatar preview"
                preview-for="#input-avatar"
                initial-sync="no"
                style="background-color: white"
            />
            {{end}}
        </div>
        <div class="element">
            <h2 id="card-name" preview-for="#input-name">
                {{ .Card.Fields.Name }}
            </h2>
        </div>
        <div
            class="element"
            hide-when-no-content="#input-position #input-company"
        >
            <div preview-for="#input-position">{{ .Card.Fields.Position }}</div>
            <div preview-for="#input-company">{{ .Card.Fields.Company }}</div>
        </div>
        <pre
            class="element"
            hide-when-no-content="#card-description"
            id="card-description"
            preview-for="#input-description"
        >
{{ .Card.Fields.Description }}</pre
        >
        <hr />
        <div class="element" style="background-color: blue">
            <img src="/static/yandex-logo.svg" />
            AAAAAAAAAA
        </div>
        {{ if .Owner }} {{if .EditUrl }}
        <a class="element" href="{{.EditUrl }}">{{ T "EditCard" .Lang }}</a>
        {{end}} {{end}}
    </div>
    <div class="layer" id="qr-layer">
        <div class="inner-container">
            <img
                class="top-img"
                src="/static/qr-code-.svg"
                toggle-visibility="#qr-layer"
            />
            <hr />
            <button class="element" toggle-visibility="#qr-layer">Back</button>
            <div class="element">Name</div>
            <div class="element">2Name</div>
        </div>
        <div></div>
        <style>
            :root {
                --card-min-width: 400px;
                --padding-in-card: 10px;
                --top-height: 50px;
                --hover-text-color: white;
                --hover-background-color: black;
                --card-font-size: 18px;
            }
            .main-container {
                background-color: red;
                width: var(--card-min-width);
                padding: var(--padding-in-card);
                position: relative;
                font-size: var(--card-font-size);
                box-sizing: border-box;
                margin-left: auto;
                margin-right: auto;
            }
            @media (max-width: 450px) {
                .main-container {
                    width: 100%;
                }
            }
            .inner-container {
                background-color: green;
            }
            .layer {
                background: gray;
                /* padding: var(--padding-in-card); */
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                min-height: 100%;
                visibility: collapse;
                display: none;
            }
            .layer .inner-container {
                margin: var(--padding-in-card);
            }
            .top-element {
                background-color: blue;
                margin-bottom: var(--padding-in-card);
                width: 100%;
                height: var(--top-height);
            }
            .top-td {
                width: calc(var(--top-height) * 1.5);
            }
            table.top-element td {
                padding: 0px;
                margin: 0px;
                height: var(--top-height);
            }
            .top-img {
                max-height: var(--top-height);
                height: 100%;
                margin: auto;
                display: block;
                box-sizing: border-box;
            }
            #card-logo {
                display: block;
                width: 100%;
                height: 100%;
                object-fit: contain;
            }
            .avatar {
                margin-bottom: var(--padding-in-card);
                display: block;
                border: none;
            }
            .avatar img {
                width: 100%;
            }
            .element {
                background-color: orange;
                padding: 5px;
                margin-bottom: var(--padding-in-card);
                text-wrap: balance;
                word-break: break-word;
                display: block;
                border: none;
                text-decoration: none;
                width: 100%;
                box-sizing: border-box;
                block-size: fit-content;
                height: fit-content;
            }
            .element h2 {
                margin: 0px;
            }
            button.element {
                width: 100%;
                font-size: var(--card-font-size);
            }
            button.element:hover {
                background-color: var(--hover-background-color);
                color: var(--hover-text-color);
            }
            a.element {
                text-align: center;
            }
            a.element:hover {
                background-color: var(--hover-background-color);
                color: var(--hover-text-color);
            }
            pre.element {
                font-family: inherit;
                font: inherit;
            }
            .element:last-child {
                margin-bottom: 0px;
            }
            .card-img-btn {
                background-color: var(--section-bg);
                padding: 0.3rem;
            }
            .card-img-btn:hover {
                background-color: var(--section-hover-bg);
            }
            .card-hidden-msg {
                color: var(--error-color);
                border: 2px solid var(--error-color);
                background-color: var(--section-bg);
                text-align: center;
            }
            #card-description {
                white-space: pre-wrap;
            }
        </style>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                document
                    .querySelectorAll("[toggle-visibility]")
                    .forEach((host) => {
                        console.log(host);
                        const selector = host.getAttribute("toggle-visibility");
                        const targets = document.querySelectorAll(selector);
                        console.log(targets);
                        host.addEventListener("click", () => {
                            targets.forEach((target) => {
                                console.log(target);
                                if (target.style.visibility != "visible") {
                                    target.style.visibility = "visible";
                                    target.style.display = "block";
                                } else {
                                    target.style.visibility = "collapse";
                                    target.style.display = "hidden";
                                }
                            });
                        });
                    });
            });
        </script>
    </div>
</div>
